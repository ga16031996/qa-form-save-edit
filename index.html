<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Email Campaign QA Form</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap" rel="stylesheet">
  <style>
    body { font-family: 'Inter', sans-serif; background: #f9f9f9; padding: 0; margin: 0; }
    header { background: #001F3F; color: white; padding: 1rem; text-align: center; }
    form { max-width: 900px; margin: 2rem auto; background: white; padding: 2rem; border-radius: 8px; box-shadow: 0 0 10px rgba(0,0,0,0.1); }
    .form-group { margin-bottom: 1rem; }
    label { display: block; font-weight: 600; margin-bottom: 0.5rem; }
    input, textarea, select { width: 100%; padding: 0.5rem; border: 1px solid #ccc; border-radius: 4px; font-size: 1rem; }
    button { background: #0074D9; color: white; padding: 0.75rem 1.5rem; border: none; border-radius: 4px; cursor: pointer; font-size: 1rem; margin-right: 10px; }
    button:hover { background: #005fa3; }
    #submissionIdDisplay { display: none; font-weight: bold; color: green; margin-top: 1rem; }
  </style>
</head>
<body>
  <header>
    <h1>Email Campaign QA Form</h1>
  </header>

  <form id="qaForm">
    <!-- Hidden tracking fields -->
    <input type="hidden" id="createDate" name="Create Date" />
    <input type="hidden" id="submissionTime" name="Submission Time" />
    <input type="hidden" id="submissionId" name="Submission ID" />

    <!-- Main Fields -->
    <div class="form-group"><label for="filledBy">Form Filled By</label><input type="text" id="filledBy" name="Form Filled By" required></div>
    <div class="form-group"><label for="clientName">Client Name</label><input type="text" id="clientName" name="Client Name" required></div>
    <div class="form-group"><label for="campaignType">Campaign Type</label><select id="campaignType" name="Campaign Type"><option value="">-- Select --</option><option>Manual Campaigns</option><option>SMS</option><option>Automation emails</option></select></div>
    <div class="form-group"><label for="jobType">Job Type</label><select id="jobType" name="Job Type"><option value="">-- Select --</option><option>Design only</option><option>Design + Coding</option><option>Coding only</option></select></div>
    <div class="form-group"><label for="noOfEmails">No of Emails</label><input type="number" id="noOfEmails" name="No of Emails"></div>
    <div class="form-group"><label for="emailName">Email/SMS/Automation Name</label><input type="text" id="emailName" name="Email/SMS/Automation Name"></div>
    <div class="form-group"><label for="esp">ESP</label><input type="text" id="esp" name="ESP"></div>
    <div class="form-group"><label for="fromName">From Name</label><input type="text" id="fromName" name="From Name"></div>
    <div class="form-group"><label for="fromEmail">From Email Address</label><input type="email" id="fromEmail" name="From Email Address"></div>
    <div class="form-group"><label for="replyToEmail">Reply-to Email Address</label><input type="email" id="replyToEmail" name="Reply-to Email Address"></div>
    <div class="form-group"><label for="subjectLine">Subject Line</label><input type="text" id="subjectLine" name="Subject Line"></div>
    <div class="form-group"><label for="previewText">Preview Text</label><input type="text" id="previewText" name="Preview Text"></div>
    <div class="form-group"><label for="abTest">A/B Testing</label><select id="abTest" name="A/B Testing"><option value="">-- Select --</option><option>Subject line A/B testing</option><option>Time</option><option>Content</option><option>Design changes / Layout changes</option><option>Other</option><option>No</option></select></div>
    <div class="form-group"><label for="abDetails">A/B Test Details</label><textarea id="abDetails" name="A/B Test Details"></textarea></div>
    <div class="form-group"><label for="mainList">Main List</label><input type="text" id="mainList" name="Main List"></div>
    <div class="form-group"><label for="segment">Segment</label><input type="text" id="segment" name="Segment"></div>
    <div class="form-group"><label for="count">Count (After Suppression)</label><input type="text" id="count" name="Count (After Suppression)"></div>
    <div class="form-group"><label for="campaignDate">Campaign Date</label><input type="date" id="campaignDate" name="Campaign Date"></div>
    <div class="form-group">
      <label for="campaignTime">Campaign Time</label>
      <input type="time" id="campaignTime" name="Campaign Time" required>
    </div>
    <div class="form-group">
      <label for="campaignTimeZone">Campaign Time Zone</label>
      <select id="campaignTimeZone" name="Campaign Time Zone" required>
        <option value="America/Los_Angeles">PST</option>
        <option value="America/Denver">MST</option>
        <option value="America/Chicago">CST</option>
        <option value="America/New_York">EST</option>
      </select>
    </div>
    <div class="form-group"><label for="testEmail">Test Email List/Person</label><input type="text" id="testEmail" name="Test Email List/Person"></div>

    <!-- QA Checks as Dropdowns -->
    <div class="form-group"><label for="linkCheck">Link Check</label><select id="linkCheck" name="Link Check"><option>Yes</option><option>No</option></select></div>
    <div class="form-group"><label for="contentError">Content Error Check</label><select id="contentError" name="Content Error Check"><option>Yes</option><option>No</option></select></div>
    <div class="form-group"><label for="altTag">Alt Tag Check</label><select id="altTag" name="Alt Tag Check"><option>Yes</option><option>No</option></select></div>
    <div class="form-group"><label for="promoCode">Promo Code?</label><input type="text" id="promoCode" name="Promo code?"></div>
    <div class="form-group"><label for="canSpam">CAN-SPAM Compliant</label><select id="canSpam" name="CAN-SPAM Compliant"><option>Yes</option><option>No</option></select></div>
    <div class="form-group"><label for="unsubscribeLink">Unsubscribe Link</label><select id="unsubscribeLink" name="Unsubscribe Link"><option>Yes</option><option>No</option></select></div>
    <div class="form-group"><label for="salutation">Salutation (First Name)</label><select id="salutation" name="Salutation(First Name)"><option>Yes</option><option>No</option></select></div>
    <div class="form-group"><label for="spf">SPF</label><select id="spf" name="SPF"><option>PASS</option><option>FAIL</option></select></div>
    <div class="form-group"><label for="dkim">DKIM</label><select id="dkim" name="DKIM"><option>PASS</option><option>FAIL</option></select></div>
    <div class="form-group"><label for="dmarc">DMARC</label><select id="dmarc" name="DMARC"><option>PASS</option><option>FAIL</option></select></div>
    <div class="form-group"><label for="utm">UTM Tracking?</label><select id="utm" name="UTM Tracking?"><option>Yes</option><option>No</option></select></div>
    <div class="form-group"><label for="liveLink">Live Campaign Link</label><input type="text" id="liveLink" name="Live Campaign Link"></div>
    <div class="form-group"><label for="eoa">EOA</label><input type="text" id="eoa" name="EOA"></div>
    <div class="form-group"><label for="rendering">Any Rendering Issues - Device Name + Platform</label><input type="text" id="rendering" name="Any Rendering Issues - Device Name + Platform"></div>

    <div class="form-group"><label for="approval">Campaign Approval</label><select id="approval" name="Campaign Approval"><option>Approved</option><option>Not Approved</option></select></div>

    <!-- Submit and Reset -->
    <button type="submit">Submit</button>
    <button type="reset">Reset</button>
    <div id="submissionIdDisplay">Your Submission ID: <span id="submissionIdValue"></span></div>
  </form>

  <script>
    // Handle form submission
    document.getElementById('qaForm').addEventListener('submit', function(e) {
      e.preventDefault();

      // Get current CST time for Create Date and Submission Time
      const cstTime = new Date().toLocaleString("en-US", { timeZone: "America/Chicago" });

      // Set the default times
      document.getElementById('createDate').value = cstTime;
      document.getElementById('submissionTime').value = cstTime;

      // Handle Campaign Time with Time Zone
      const campaignTime = document.getElementById('campaignTime').value;
      const campaignTimeZone = document.getElementById('campaignTimeZone').value;
      document.getElementById('submissionId').value = Date.now(); // You can use UUID generation as an alternative.

      // Send data to Google Apps Script
      const formData = new FormData(document.getElementById('qaForm'));
      fetch('<YOUR_GOOGLE_SCRIPT_WEB_APP_URL>', {
        method: 'POST',
        body: formData
      })
      .then(response => response.text())
      .then(submissionId => {
        // Display Submission ID
        document.getElementById('submissionIdValue').textContent = submissionId;
        document.getElementById('submissionIdDisplay').style.display = 'block';
      })
      .catch(error => alert('Error submitting form: ' + error));
    });
  </script>
</body>
</html>
