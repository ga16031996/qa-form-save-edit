<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Email Campaign QA Form</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap" rel="stylesheet">
  <style>
    body { font-family: 'Inter', sans-serif; background: #f9f9f9; padding: 0; margin: 0; }
    header { background: #001F3F; color: white; padding: 1rem; text-align: center; }
    form { max-width: 900px; margin: 2rem auto; background: white; padding: 2rem; border-radius: 8px; box-shadow: 0 0 10px rgba(0,0,0,0.1); }
    .form-group { margin-bottom: 1rem; }
    label { display: block; font-weight: 600; margin-bottom: 0.5rem; }
    input, textarea, select { width: 100%; padding: 0.5rem; border: 1px solid #ccc; border-radius: 4px; font-size: 1rem; }
    button { background: #0074D9; color: white; padding: 0.75rem 1.5rem; border: none; border-radius: 4px; cursor: pointer; font-size: 1rem; margin-right: 10px; }
    button:hover { background: #005fa3; }
    #submissionIdDisplay { display: none; font-weight: bold; color: green; margin-top: 1rem; }
  </style>
</head>
<body>
  <header>
    <h1>Email Campaign QA Form</h1>
  </header>

  <form id="qaForm">
    <!-- Hidden tracking fields -->
    <input type="hidden" id="createDate" name="Create Date" />
    <input type="hidden" id="submissionTime" name="Submission Time" />
    <input type="hidden" id="submissionId" name="Submission ID" />

    <!-- Main Fields -->
    <div class="form-group"><label for="filledBy">Form Filled By</label><input type="text" id="filledBy" name="Form Filled By" required></div>
    <div class="form-group"><label for="clientName">Client Name</label><input type="text" id="clientName" name="Client Name" required></div>
    <div class="form-group"><label for="campaignType">Campaign Type</label><input type="text" id="campaignType" name="Campaign Type" /></div>
    <div class="form-group"><label for="jobType">Job Type</label><input type="text" id="jobType" name="Job Type" /></div>
    <div class="form-group"><label for="noOfEmails">No of Emails</label><input type="number" id="noOfEmails" name="No of Emails" /></div>
    <div class="form-group"><label for="emailName">Email/SMS/Automation Name</label><input type="text" id="emailName" name="Email/SMS/Automation Name" /></div>
    <div class="form-group"><label for="esp">ESP</label><input type="text" id="esp" name="ESP" /></div>
    <div class="form-group"><label for="fromName">From Name</label><input type="text" id="fromName" name="From Name" /></div>
    <div class="form-group"><label for="fromEmail">From Email Address</label><input type="email" id="fromEmail" name="From Email Address" /></div>
    <div class="form-group"><label for="replyToEmail">Reply-to Email Address</label><input type="email" id="replyToEmail" name="Reply-to Email Address" /></div>
    <div class="form-group"><label for="subjectLine">Subject Line</label><input type="text" id="subjectLine" name="Subject Line" /></div>
    <div class="form-group"><label for="previewText">Preview Text</label><input type="text" id="previewText" name="Preview Text" /></div>
    <div class="form-group"><label for="abTest">A/B Testing</label><input type="text" id="abTest" name="A/B Testing" /></div>
    <div class="form-group"><label for="abDetails">A/B Test Details</label><textarea id="abDetails" name="A/B Test Details"></textarea></div>
    <div class="form-group"><label for="mainList">Main List</label><input type="text" id="mainList" name="Main List" /></div>
    <div class="form-group"><label for="segment">Segment</label><input type="text" id="segment" name="Segment" /></div>
    <div class="form-group"><label for="count">Count (After Suppression)</label><input type="number" id="count" name="Count (After Suppression)" /></div>
    <div class="form-group"><label for="campaignDate">Campaign Date</label><input type="date" id="campaignDate" name="Campaign Date" /></div>
    <div class="form-group"><label for="campaignTime">Campaign Time</label><input type="time" id="campaignTime" name="Campaign Time" /></div>
    <div class="form-group"><label for="testEmail">Test Email List/Person</label><input type="email" id="testEmail" name="Test Email List/Person" /></div>
    <div class="form-group"><label><input type="checkbox" name="Link Check" /> Link Check</label></div>
    <div class="form-group"><label><input type="checkbox" name="Content Error Check" /> Content Error Check</label></div>
    <div class="form-group"><label><input type="checkbox" name="Alt Tag Check" /> Alt Tag Check</label></div>
    <div class="form-group"><label for="promoCode">Promo Code?</label><input type="text" id="promoCode" name="Promo code?" /></div>
    <div class="form-group"><label><input type="checkbox" name="CAN-SPAM Compliant" /> CAN-SPAM Compliant</label></div>
    <div class="form-group"><label><input type="checkbox" name="Unsubscribe Link" /> Unsubscribe Link</label></div>
    <div class="form-group"><label><input type="checkbox" name="Salutation(First Name)" /> Salutation (First Name)</label></div>
    <div class="form-group"><label for="spf">SPF</label><select id="spf" name="SPF"><option>PASS</option><option>FAIL</option></select></div>
    <div class="form-group"><label for="dkim">DKIM</label><select id="dkim" name="DKIM"><option>PASS</option><option>FAIL</option></select></div>
    <div class="form-group"><label for="dmarc">DMARC</label><select id="dmarc" name="DMARC"><option>PASS</option><option>FAIL</option></select></div>
    <div class="form-group"><label><input type="checkbox" name="UTM Tracking?" /> UTM Tracking?</label></div>
    <div class="form-group"><label for="liveLink">Live Campaign Link</label><input type="text" id="liveLink" name="Live Campaign Link" /></div>
    <div class="form-group"><label for="eoa">EOA</label><input type="text" id="eoa" name="EOA" /></div>
    <div class="form-group"><label for="renderingIssues">Any Rendering Issues</label><textarea id="renderingIssues" name="Any Rendering Issues - Device Name + Platform"></textarea></div>
    <div class="form-group"><label for="approval">Campaign Approval</label><input type="text" id="approval" name="Campaign Approval" /></div>
    <div class="form-group"><label for="links">LINKS (Title + Link)</label><textarea id="links" name="LINKS"></textarea></div>

    <!-- Buttons -->
    <button type="button" id="saveBtn">Save</button>
    <button type="submit">Submit</button>
    <p id="submissionIdDisplay"></p>
  </form>

  <!-- Fetch/Edit Existing Entry -->
  <form id="editForm" style="max-width: 900px; margin: auto;">
    <div style="max-width: 900px; margin: 2rem auto; padding: 1rem;">
  <h3>Edit Existing Submission</h3>
  <label for="editId">Enter Submission ID to Edit</label>
  <input type="text" id="editId" placeholder="e.g., 12345" />
  <button type="button" onclick="loadSubmission()">Fetch/Edit</button>
</div>
  </form>

<script>
  const scriptURL = 'https://script.google.com/macros/s/AKfycbylZD8BoXlufrjxxZoKaUidoWC7p5lGYSvE2653JVuojJZtU7NBlIPQWTnKFW7L2CwkyQ/exec';
  const form = document.getElementById('qaForm');

  window.onload = () => {
    document.getElementById("createDate").value = new Date().toISOString().split("T")[0];
  };

  form.addEventListener('submit', e => handleSubmit(e, "submit"));
  document.getElementById('saveBtn').addEventListener('click', e => handleSubmit(e, "save"));

  function handleSubmit(e, status) {
    e.preventDefault();
    document.getElementById("submissionTime").value = new Date().toLocaleString();

    const formData = new FormData(form);
    formData.append("Form Status", status);

    fetch(scriptURL, { method: 'POST', body: formData })
      .then(res => res.text())
      .then(id => {
        document.getElementById('submissionId').value = id;
        document.getElementById('submissionIdDisplay').innerText = `Submission ID: ${id}`;
        document.getElementById('submissionIdDisplay').style.display = 'block';
        alert(`${status === 'save' ? 'Saved' : 'Submitted'} successfully!`);
      })
      .catch(err => alert("Error submitting form: " + err));
  }
  
  function loadSubmission() {
  const editId = document.getElementById('editId').value.trim();
  if (!editId) return alert("Enter a valid Submission ID.");

  fetch(`${scriptURL}?Submission ID=${editId}`)
    .then(res => res.json())
    .then(data => {
      if (data.error) return alert(data.error);
      for (const key in data) {
        const field = document.querySelector(`[name="${key}"]`);
        if (field) {
          if (field.type === "checkbox") {
            field.checked = data[key] === "TRUE";
          } else {
            field.value = data[key];
          }
        }
      }
      document.getElementById("submissionId").value = editId;
    })
    .catch(() => alert("Failed to load submission."));
}


</script>
</body>
</html>
